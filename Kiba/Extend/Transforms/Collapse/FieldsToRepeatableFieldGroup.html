<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Kiba::Extend::Transforms::Collapse::FieldsToRepeatableFieldGroup
  
    &mdash; Kiba-Extend Documentation
  
</title>

  <link rel="stylesheet" href="../../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Kiba::Extend::Transforms::Collapse::FieldsToRepeatableFieldGroup";
  relpath = '../../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../../_index.html">Index (F)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../Kiba.html" title="Kiba (module)">Kiba</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Extend.html" title="Kiba::Extend (module)">Extend</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Transforms.html" title="Kiba::Extend::Transforms (module)">Transforms</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Collapse.html" title="Kiba::Extend::Transforms::Collapse (module)">Collapse</a></span></span>
     &raquo; 
    <span class="title">FieldsToRepeatableFieldGroup</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Kiba::Extend::Transforms::Collapse::FieldsToRepeatableFieldGroup
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Kiba::Extend::Transforms::Collapse::FieldsToRepeatableFieldGroup</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/kiba/extend/transforms/collapse/fields_to_repeatable_field_group.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Combines data from multiple fields following an expected naming
  pattern (shown in examples below) into final fields that are part of
  a repeatable fieldgroup.</p>

<p>This transform can be seen as a more opinionated, structured
  shorthand for <span class='object_link'><a href="FieldsWithCustomFieldmap.html" title="Kiba::Extend::Transforms::Collapse::FieldsWithCustomFieldmap (class)">FieldsWithCustomFieldmap</a></span>, which does not
  make the same assumptions about the field names/patterns involved,
  nor about field groups and field group evenness.</p>

<p>Goes through the following steps:</p>

<ul>
<li>Runs <span class='object_link'><a href="../Replace/EmptyFieldValues.html" title="Kiba::Extend::Transforms::Replace::EmptyFieldValues (class)">Replace::EmptyFieldValues</a></span> to replace source fields values
that are nil or empty (the full field value) with value of given for
<code>null_placeholder</code>. This avoids odd situations where dropping fields
because they are empty at this point introduces unevenness.</li>
<li>If <code>enforce_evenness: true</code>, ensure all fields from a given source
have the same number of values by running <span class='object_link'><a href="../Clean/EvenFieldValues.html" title="Kiba::Extend::Transforms::Clean::EvenFieldValues (class)">Kiba::Extend::Transforms::Clean::EvenFieldValues</a></span>
with <code>evener: even_val</code>, <code>treat_as_null: null_placeholder</code>, and
<code>warn: warn_if_uneven</code></li>
<li>Uses <span class='object_link'><a href="../Helpers/FieldValueGetter.html" title="Kiba::Extend::Transforms::Helpers::FieldValueGetter (class)">Helpers::FieldValueGetter</a></span> with <code>discard: []</code> (i.e. keep all
values) to gather and combine values from source fields for a given
target into the target value</li>
<li>Deletes source fields</li>
<li>Runs <span class='object_link'><a href="../Replace/EmptyFieldValues.html" title="Kiba::Extend::Transforms::Replace::EmptyFieldValues (class)">Replace::EmptyFieldValues</a></span> on target fields, with
<code>delim: delim</code> (turns on replacement of individual empty values in a
multi-value string) and <code>value: null_placeholder</code></li>
<li>If <code>empty_groups: delete</code>, runs <span class='object_link'><a href="../Delete/EmptyFieldGroups.html" title="Kiba::Extend::Transforms::Delete::EmptyFieldGroups (class)">Delete::EmptyFieldGroups</a></span> on target
fields with <code>treat_as_null: [null_placeholder, even_val].uniq</code></li>
<li>Runs <span class='object_link'><a href="../Delete/DelimiterOnlyFieldValues.html" title="Kiba::Extend::Transforms::Delete::DelimiterOnlyFieldValues (class)">Delete::DelimiterOnlyFieldValues</a></span> on target fields with
<code>treat_as_null: null_placeholder</code></li>
</ul>

<h2 id="general-example">General example</h2>

<p>As an example, let&#39;s use example original source data:</p>

<pre class="code ruby"><code class="ruby"><span class='lbrace'>{</span>
  <span class='label'>displayideas:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>blah</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='label'>ideadate:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>2022-07-07</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='label'>creditline:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>from someone</span><span class='tstring_end'>&#39;</span></span>
<span class='rbrace'>}</span>
</code></pre>

<p>We want data from :displayideas and :creditline to both get mapped to
  annotation note fields, and we want the annotation type and
  annotation date fields set as appropriate.</p>

<p>In order to apply this transform, we must first get the source data
  into the expected format (This must be achieved via other transforms
  before applying this one):</p>

<pre class="code ruby"><code class="ruby"><span class='lbrace'>{</span>
  <span class='label'>idea_annotationtype:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>display idea</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='label'>idea_annotationdate:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>2022-07-07</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='label'>idea_annotationnote:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>blah</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='label'>cl_annotationtype:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>credit line</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='label'>cl_annotationnote:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>from someone</span><span class='tstring_end'>&#39;</span></span>
<span class='rbrace'>}</span>
</code></pre>

<p>Requirements of this pattern:</p>

<ul>
<li>consistent prefix indicating orig source data</li>
<li>suffix is the eventual target field that the values will be combined
into</li>
<li>prefix and suffix separated by underscore</li>
</ul>

<p>Then we can use this transform as follows:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_transform'>transform</span> <span class='const'><span class='object_link'><a href="../Collapse.html" title="Kiba::Extend::Transforms::Collapse (module)">Collapse</a></span></span><span class='op'>::</span><span class='const'>FieldsToRepeatableFieldGroup</span><span class='comma'>,</span>
  <span class='label'>sources:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>cl</span><span class='words_sep'> </span><span class='tstring_content'>idea</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
  <span class='label'>targets:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>annotationtype</span><span class='words_sep'> </span><span class='tstring_content'>annotationnote</span><span class='words_sep'> </span><span class='tstring_content'>annotationdate</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
  <span class='label'>delim:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>|</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>And the result will be:</p>

<pre class="code ruby"><code class="ruby">{
  annotationtype: &#39;credit line|display idea&#39;,
  annotationnote: &#39;from someone|blah&#39;,
  annotationdate: &#39;%NULLVALUE%&#39;|2022-07-07&#39;
}
</code></pre>

<h2 id="specific-examples-parameter-effects">Specific examples/parameter effects</h2>

<h3 id="blank-null-values-null_placeholder-parameter">Blank/null values (<code>:null_placeholder</code> parameter)</h3>

<p>Prior to any other processing, empty or nil whole-field values are
  converted to a string representing a null value. After target fields
  are compiled, any individual null/empty values within a joined
  String is also converted to this null-value representing string.
  This behavior cannot be disabled.</p>

<p>The null placeholder string used by default is the value of
  <code>Kiba::Extend.nullvalue</code> (default = &#39;%NULLVALUE%&#39;)</p>

<p>You can change this as follows:</p>

<p>Source data:</p>

<pre class="code ruby"><code class="ruby"><span class='lbracket'>[</span>
  <span class='lbrace'>{</span>
    <span class='label'>a_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a|f</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>a_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>b_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bf</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>b_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>b</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>c_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>c_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>c</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>d_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>d|</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>d_bar:</span> <span class='kw'>nil</span>
  <span class='rbrace'>}</span>
<span class='rbracket'>]</span>
</code></pre>

<p>Use this transform as follows:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_transform'>transform</span> <span class='const'><span class='object_link'><a href="../Collapse.html" title="Kiba::Extend::Transforms::Collapse (module)">Collapse</a></span></span><span class='op'>::</span><span class='const'>FieldsToRepeatableFieldGroup</span><span class='comma'>,</span>
  <span class='label'>sources:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>a</span><span class='words_sep'> </span><span class='tstring_content'>b</span><span class='words_sep'> </span><span class='tstring_content'>c</span><span class='words_sep'> </span><span class='tstring_content'>d</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
  <span class='label'>targets:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>foo</span><span class='words_sep'> </span><span class='tstring_content'>bar</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
  <span class='label'>delim:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>|</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='label'>null_placeholder:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BLANK</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>And the result will be:</p>

<pre class="code ruby"><code class="ruby"><span class='lbracket'>[</span>
  <span class='lbrace'>{</span>
    <span class='label'>foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a|f|bf|BLANK|d</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a|%NULLVALUE%|b|c|BLANK</span><span class='tstring_end'>&#39;</span></span>
  <span class='rbrace'>}</span>
<span class='rbracket'>]</span>
</code></pre>

<p><strong>Note that there are still some &#39;%NULLVALUE%&#39;s in there.</strong> This is
  because we did not change the <code>even_val</code> parameter from its default
  value. The &#39;%NULLVALUE%&#39;s were added to achieve even field values.</p>

<h3 id="automatic-removal-of-grouped-field-with-no-values-in-group">Automatic removal of grouped field with no values in group</h3>

<p>By default, <code>empty_groups: :delete</code>. This causes the
  <span class='object_link'><a href="../Clean/EmptyFieldGroups.html" title="Kiba::Extend::Transforms::Clean::EmptyFieldGroups (class)">Kiba::Extend::Transforms::Clean::EmptyFieldGroups</a></span> transform (with <code>use_nullvalue: true</code>) to
  be applied after the target fields are compiled, so that, with the
  following source data:</p>

<pre class="code ruby"><code class="ruby"><span class='lbracket'>[</span>
  <span class='lbrace'>{</span><span class='label'>a_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>afoo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>a_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abar</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>b_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bfoo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>b_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bbar</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span><span class='label'>a_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>afoo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>a_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abar</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>b_foo:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>b_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span><span class='label'>a_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>afoo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>a_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abar</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>b_foo:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>b_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%NULLVALUE%</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span><span class='label'>a_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>afoo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>a_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%NULLVALUE%</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>b_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%NULLVALUE%</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>b_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bbar</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span><span class='label'>a_foo:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>a_bar:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>b_foo:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>b_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span><span class='label'>a_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>afoo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>a_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abar</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>b_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bfoo</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
<span class='rbracket'>]</span>
</code></pre>

<p>And this usage:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_transform'>transform</span> <span class='const'><span class='object_link'><a href="../Collapse.html" title="Kiba::Extend::Transforms::Collapse (module)">Collapse</a></span></span><span class='op'>::</span><span class='const'>FieldsToRepeatableFieldGroup</span><span class='comma'>,</span>
  <span class='label'>sources:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>a</span><span class='words_sep'> </span><span class='tstring_content'>b</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
  <span class='label'>targets:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>foo</span><span class='words_sep'> </span><span class='tstring_content'>bar</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
  <span class='label'>delim:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>|</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>The result will be:</p>

<pre class="code ruby"><code class="ruby"><span class='lbracket'>[</span>
  <span class='lbrace'>{</span><span class='label'>foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>afoo|bfoo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abar|bbar</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span><span class='label'>foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>afoo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abar</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span><span class='label'>foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>afoo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abar</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span><span class='label'>foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>afoo|%NULLVALUE%</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%NULLVALUE%|bbar</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span><span class='label'>foo:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>bar:</span> <span class='kw'>nil</span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span><span class='label'>foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>afoo|bfoo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abar|%NULLVALUE%</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span>
<span class='rbracket'>]</span>
</code></pre>

<p>If you do not want empty field groups removed, do:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_transform'>transform</span> <span class='const'><span class='object_link'><a href="../Cspace.html" title="Kiba::Extend::Transforms::Cspace (module)">Cspace</a></span></span><span class='op'>::</span><span class='const'>FieldsToRepeatableFieldGroup</span><span class='comma'>,</span>
  <span class='label'>sources:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>a</span><span class='words_sep'> </span><span class='tstring_content'>b</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
  <span class='label'>targets:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>foo</span><span class='words_sep'> </span><span class='tstring_content'>bar</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
  <span class='label'>delim:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>|</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='label'>empty_groups:</span> <span class='symbol'>:retain</span>
</code></pre>

<p>The result will be:</p>

<pre class="code ruby"><code class="ruby"><span class='lbracket'>[</span>
  <span class='lbrace'>{</span><span class='label'>foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>afoo|bfoo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abar|bbar</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span><span class='label'>foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>afoo|%NULLVALUE%</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abar|%NULLVALUE%</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span><span class='label'>foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>afoo|%NULLVALUE%</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abar|%NULLVALUE%</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span><span class='label'>foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>afoo|%NULLVALUE%</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%NULLVALUE%|bbar</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span><span class='label'>foo:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>bar:</span> <span class='kw'>nil</span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span><span class='label'>foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>afoo|bfoo</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abar|%NULLVALUE%</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span>
<span class='rbracket'>]</span>
</code></pre>

<h2 id="enforcing-evenness">Enforcing evenness</h2>

<p>See <span class='object_link'><a href="../Warn/UnevenFields.html" title="Kiba::Extend::Transforms::Warn::UnevenFields (class)">Warn::UnevenFields</a></span> for explanation of what is meant by evenness.</p>

<p>See <span class='object_link'><a href="../Clean/EvenFieldValues.html" title="Kiba::Extend::Transforms::Clean::EvenFieldValues (class)">Kiba::Extend::Transforms::Clean::EvenFieldValues</a></span> for details on how fields are evened if
  <code>enforce_evenness: true</code>.</p>

<p>With source data:</p>

<pre class="code ruby"><code class="ruby"><span class='lbracket'>[</span>
  <span class='lbrace'>{</span>
    <span class='label'>a_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a|f</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>a_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>b_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bf</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>b_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>b</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>c_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>c_bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>c</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>d_foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>d|</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>d_bar:</span> <span class='kw'>nil</span>
  <span class='rbrace'>}</span>
<span class='rbracket'>]</span>
</code></pre>

<p>And tranform:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_transform'>transform</span> <span class='const'><span class='object_link'><a href="../Cspace.html" title="Kiba::Extend::Transforms::Cspace (module)">Cspace</a></span></span><span class='op'>::</span><span class='const'>FieldsToRepeatableFieldGroup</span><span class='comma'>,</span>
  <span class='label'>sources:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>a</span><span class='words_sep'> </span><span class='tstring_content'>b</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
  <span class='label'>targets:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>foo</span><span class='words_sep'> </span><span class='tstring_content'>bar</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
  <span class='label'>delim:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>|</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='label'>enforce_evenness:</span> <span class='kw'>false</span>
</code></pre>

<p>The result will be:</p>

<pre class="code ruby"><code class="ruby"><span class='lbracket'>[</span>
  <span class='lbrace'>{</span>
    <span class='label'>foo:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a|f|bf|%NULLVALUE%|d|%NULLVALUE%</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>bar:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a|b|c|%NULLVALUE%</span><span class='tstring_end'>&#39;</span></span>
  <span class='rbrace'>}</span>
<span class='rbracket'>]</span>
</code></pre>

<p>Note that we did not pass in <code>empty_groups: retain</code>, but we get an
  empty group (the 4th value in <code>foo</code> and the 4th/final value in
  <code>bar</code>)</p>

<p>This is because <span class='object_link'><a href="../Clean/EmptyFieldGroups.html" title="Kiba::Extend::Transforms::Clean::EmptyFieldGroups (class)">Kiba::Extend::Transforms::Clean::EmptyFieldGroups</a></span> avoids making any changes
  when it detects uneven fields, because how the values should
  actually line up (and thus what is actually empty) is ambiguous.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>2.9.0</p>
</div>
      
    </li>
  
</ul>

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(sources:, targets:, delim: Kiba::Extend.delim, null_placeholder: Kiba::Extend.nullvalue, even_val: Kiba::Extend.nullvalue, empty_groups: :delete, enforce_evenness: true, warn_if_uneven: true)  &#x21d2; FieldsToRepeatableFieldGroup </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A new instance of FieldsToRepeatableFieldGroup.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#process-instance_method" title="#process (instance method)">#<strong>process</strong>(row)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(sources:, targets:, delim: Kiba::Extend.delim, null_placeholder: Kiba::Extend.nullvalue, even_val: Kiba::Extend.nullvalue, empty_groups: :delete, enforce_evenness: true, warn_if_uneven: true)  &#x21d2; <tt><span class='object_link'><a href="" title="Kiba::Extend::Transforms::Collapse::FieldsToRepeatableFieldGroup (class)">FieldsToRepeatableFieldGroup</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns a new instance of FieldsToRepeatableFieldGroup.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>sources</span>
      
      
        <span class='type'>(<tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the list of original source fields
that field group intermediate fields were derived from (with
<code>source_targetfield</code> pattern)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>targets</span>
      
      
        <span class='type'>(<tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the list of final field group fields
that the intermediate fields will be combined into</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>delim</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>Kiba::Extend.delim</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>used to split/join multiple values in a field</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>null_placeholder</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>Kiba::Extend.nullvalue</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>used to replace nil or empty values</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>even_val</span>
      
      
        <span class='type'>(<tt>:value</tt>, <tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>Kiba::Extend.nullvalue</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>passed as <code>evener</code> parameter to
<span class='object_link'><a href="../Clean/EvenFieldValues.html" title="Kiba::Extend::Transforms::Clean::EvenFieldValues (class)">Kiba::Extend::Transforms::Clean::EvenFieldValues</a></span> when <code>enforce_evenness: true</code>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>empty_groups</span>
      
      
        <span class='type'>(<tt>:delete</tt>, <tt>:retain</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:delete</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>treatment of empty field
groups (i.e. all target field values in the same position are
empty)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>enforce_evenness</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>whether to pad target fields with
%NULLVALUE%s to ensure they all have the same number of values</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>warn_if_uneven</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>whether <span class='object_link'><a href="../Clean/EvenFieldValues.html" title="Kiba::Extend::Transforms::Clean::EvenFieldValues (class)">Kiba::Extend::Transforms::Clean::EvenFieldValues</a></span>
should print warnings about uneven field groups to STDOUT</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>2.9.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/kiba/extend/transforms/collapse/fields_to_repeatable_field_group.rb', line 278</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span>
  <span class='label'>sources:</span><span class='comma'>,</span>
  <span class='label'>targets:</span><span class='comma'>,</span>
  <span class='label'>delim:</span> <span class='const'><span class='object_link'><a href="../../../../Kiba.html" title="Kiba (module)">Kiba</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Extend.html" title="Kiba::Extend (module)">Extend</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delim'><span class='object_link'><a href="../../../Extend.html#delim-class_method" title="Kiba::Extend.delim (method)">delim</a></span></span><span class='comma'>,</span>
  <span class='label'>null_placeholder:</span> <span class='const'><span class='object_link'><a href="../../../../Kiba.html" title="Kiba (module)">Kiba</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Extend.html" title="Kiba::Extend (module)">Extend</a></span></span><span class='period'>.</span><span class='id identifier rubyid_nullvalue'><span class='object_link'><a href="../../../Extend.html#nullvalue-class_method" title="Kiba::Extend.nullvalue (method)">nullvalue</a></span></span><span class='comma'>,</span>
  <span class='label'>even_val:</span> <span class='const'><span class='object_link'><a href="../../../../Kiba.html" title="Kiba (module)">Kiba</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Extend.html" title="Kiba::Extend (module)">Extend</a></span></span><span class='period'>.</span><span class='id identifier rubyid_nullvalue'><span class='object_link'><a href="../../../Extend.html#nullvalue-class_method" title="Kiba::Extend.nullvalue (method)">nullvalue</a></span></span><span class='comma'>,</span>
  <span class='label'>empty_groups:</span> <span class='symbol'>:delete</span><span class='comma'>,</span>
  <span class='label'>enforce_evenness:</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='label'>warn_if_uneven:</span> <span class='kw'>true</span>
<span class='rparen'>)</span>
  <span class='ivar'>@sources</span> <span class='op'>=</span> <span class='id identifier rubyid_sources'>sources</span>
  <span class='ivar'>@targets</span> <span class='op'>=</span> <span class='id identifier rubyid_targets'>targets</span>
  <span class='ivar'>@delim</span> <span class='op'>=</span> <span class='id identifier rubyid_delim'>delim</span>
  <span class='ivar'>@null_placeholder</span> <span class='op'>=</span> <span class='id identifier rubyid_null_placeholder'>null_placeholder</span>
  <span class='ivar'>@even_val</span> <span class='op'>=</span> <span class='id identifier rubyid_even_val'>even_val</span>
  <span class='ivar'>@empty_groups</span> <span class='op'>=</span> <span class='id identifier rubyid_empty_groups'>empty_groups</span>
  <span class='ivar'>@enforce_evenness</span> <span class='op'>=</span> <span class='id identifier rubyid_enforce_evenness'>enforce_evenness</span>
  <span class='ivar'>@warn_if_uneven</span> <span class='op'>=</span> <span class='id identifier rubyid_warn_if_uneven'>warn_if_uneven</span>

  <span class='ivar'>@srcfieldgroups</span> <span class='op'>=</span> <span class='id identifier rubyid_sources'>sources</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_source'>source</span><span class='op'>|</span>
    <span class='id identifier rubyid_targets'>targets</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_target'>target</span><span class='op'>|</span>
      <span class='id identifier rubyid_field_name'>field_name</span><span class='lparen'>(</span><span class='id identifier rubyid_source'>source</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='ivar'>@srcemptyreplacers</span> <span class='op'>=</span> <span class='id identifier rubyid_srcfieldgroups'>srcfieldgroups</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_grp'>grp</span><span class='op'>|</span>
    <span class='const'><span class='object_link'><a href="../../../../Kiba.html" title="Kiba (module)">Kiba</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Extend.html" title="Kiba::Extend (module)">Extend</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Transforms.html" title="Kiba::Extend::Transforms (module)">Transforms</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Replace.html" title="Kiba::Extend::Transforms::Replace (module)">Replace</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Replace/EmptyFieldValues.html" title="Kiba::Extend::Transforms::Replace::EmptyFieldValues (class)">EmptyFieldValues</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Replace/EmptyFieldValues.html#initialize-instance_method" title="Kiba::Extend::Transforms::Replace::EmptyFieldValues#initialize (method)">new</a></span></span><span class='lparen'>(</span>
      <span class='label'>fields:</span> <span class='id identifier rubyid_grp'>grp</span><span class='comma'>,</span>
      <span class='label'>value:</span> <span class='id identifier rubyid_null_placeholder'>null_placeholder</span>
    <span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='ivar'>@srceveners</span> <span class='op'>=</span> <span class='id identifier rubyid_srcfieldgroups'>srcfieldgroups</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_grp'>grp</span><span class='op'>|</span>
    <span class='const'><span class='object_link'><a href="../../../../Kiba.html" title="Kiba (module)">Kiba</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Extend.html" title="Kiba::Extend (module)">Extend</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Transforms.html" title="Kiba::Extend::Transforms (module)">Transforms</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Clean.html" title="Kiba::Extend::Transforms::Clean (module)">Clean</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Clean/EvenFieldValues.html" title="Kiba::Extend::Transforms::Clean::EvenFieldValues (class)">EvenFieldValues</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Clean/EvenFieldValues.html#initialize-instance_method" title="Kiba::Extend::Transforms::Clean::EvenFieldValues#initialize (method)">new</a></span></span><span class='lparen'>(</span>
      <span class='label'>fields:</span> <span class='id identifier rubyid_grp'>grp</span><span class='comma'>,</span>
      <span class='label'>evener:</span> <span class='id identifier rubyid_even_val'>even_val</span><span class='comma'>,</span>
      <span class='label'>delim:</span> <span class='id identifier rubyid_delim'>delim</span><span class='comma'>,</span>
      <span class='label'>warn:</span> <span class='id identifier rubyid_warn_if_uneven'>warn_if_uneven</span><span class='comma'>,</span>
      <span class='label'>treat_as_null:</span> <span class='id identifier rubyid_null_placeholder'>null_placeholder</span>
    <span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='ivar'>@to_combine</span> <span class='op'>=</span> <span class='id identifier rubyid_targets'>targets</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_target'>target</span><span class='op'>|</span>
    <span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='comma'>,</span>
      <span class='const'><span class='object_link'><a href="../../../../Kiba.html" title="Kiba (module)">Kiba</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../../Extend.html" title="Kiba::Extend (module)">Extend</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Transforms.html" title="Kiba::Extend::Transforms (module)">Transforms</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Helpers.html" title="Kiba::Extend::Transforms::Helpers (module)">Helpers</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Helpers/FieldValueGetter.html" title="Kiba::Extend::Transforms::Helpers::FieldValueGetter (class)">FieldValueGetter</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Helpers/FieldValueGetter.html#initialize-instance_method" title="Kiba::Extend::Transforms::Helpers::FieldValueGetter#initialize (method)">new</a></span></span><span class='lparen'>(</span>
        <span class='label'>fields:</span> <span class='id identifier rubyid_sources'>sources</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_src'>src</span><span class='op'>|</span> <span class='id identifier rubyid_field_name'>field_name</span><span class='lparen'>(</span><span class='id identifier rubyid_src'>src</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='comma'>,</span>
        <span class='label'>delim:</span> <span class='id identifier rubyid_delim'>delim</span><span class='comma'>,</span>
        <span class='label'>discard:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='rparen'>)</span><span class='rbracket'>]</span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>
  <span class='ivar'>@field_group_cleaner</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Delete.html" title="Kiba::Extend::Transforms::Delete (module)">Delete</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Delete/EmptyFieldGroups.html" title="Kiba::Extend::Transforms::Delete::EmptyFieldGroups (class)">EmptyFieldGroups</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Delete/EmptyFieldGroups.html#initialize-instance_method" title="Kiba::Extend::Transforms::Delete::EmptyFieldGroups#initialize (method)">new</a></span></span><span class='lparen'>(</span>
    <span class='label'>groups:</span> <span class='lbracket'>[</span><span class='id identifier rubyid_targets'>targets</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='label'>delim:</span> <span class='id identifier rubyid_delim'>delim</span><span class='comma'>,</span>
    <span class='label'>treat_as_null:</span> <span class='id identifier rubyid_empty_field_group_treat_as_null'>empty_field_group_treat_as_null</span>
  <span class='rparen'>)</span>
  <span class='ivar'>@delim_only_cleaner</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Delete.html" title="Kiba::Extend::Transforms::Delete (module)">Delete</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Delete/DelimiterOnlyFieldValues.html" title="Kiba::Extend::Transforms::Delete::DelimiterOnlyFieldValues (class)">DelimiterOnlyFieldValues</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Delete/DelimiterOnlyFieldValues.html#initialize-instance_method" title="Kiba::Extend::Transforms::Delete::DelimiterOnlyFieldValues#initialize (method)">new</a></span></span><span class='lparen'>(</span>
    <span class='label'>fields:</span> <span class='id identifier rubyid_targets'>targets</span><span class='comma'>,</span> <span class='label'>delim:</span> <span class='id identifier rubyid_delim'>delim</span><span class='comma'>,</span> <span class='label'>treat_as_null:</span> <span class='id identifier rubyid_null_placeholder'>null_placeholder</span>
  <span class='rparen'>)</span>
  <span class='ivar'>@empty_replacer</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Replace.html" title="Kiba::Extend::Transforms::Replace (module)">Replace</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Replace/EmptyFieldValues.html" title="Kiba::Extend::Transforms::Replace::EmptyFieldValues (class)">EmptyFieldValues</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Replace/EmptyFieldValues.html#initialize-instance_method" title="Kiba::Extend::Transforms::Replace::EmptyFieldValues#initialize (method)">new</a></span></span><span class='lparen'>(</span>
    <span class='label'>fields:</span> <span class='id identifier rubyid_targets'>targets</span><span class='comma'>,</span>
    <span class='label'>delim:</span> <span class='id identifier rubyid_delim'>delim</span><span class='comma'>,</span>
    <span class='label'>value:</span> <span class='id identifier rubyid_null_placeholder'>null_placeholder</span>
  <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="process-instance_method">
  
    #<strong>process</strong>(row)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>2.9.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


340
341
342
343
344
345
346
347
348
349
350
351
352
353</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/kiba/extend/transforms/collapse/fields_to_repeatable_field_group.rb', line 340</span>

<span class='kw'>def</span> <span class='id identifier rubyid_process'>process</span><span class='lparen'>(</span><span class='id identifier rubyid_row'>row</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_srcemptyreplacers'>srcemptyreplacers</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_replacer'>replacer</span><span class='op'>|</span> <span class='id identifier rubyid_replacer'>replacer</span><span class='period'>.</span><span class='id identifier rubyid_process'>process</span><span class='lparen'>(</span><span class='id identifier rubyid_row'>row</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_enforce_evenness'>enforce_evenness</span>
    <span class='id identifier rubyid_srceveners'>srceveners</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_process'>process</span><span class='lparen'>(</span><span class='id identifier rubyid_row'>row</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_to_combine'>to_combine</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_target'>target</span><span class='comma'>,</span> <span class='id identifier rubyid_getter'>getter</span><span class='op'>|</span>
    <span class='id identifier rubyid_row'>row</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_getter'>getter</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_row'>row</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_delim'>delim</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_delete_sources'>delete_sources</span><span class='lparen'>(</span><span class='id identifier rubyid_row'>row</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_empty_replacer'>empty_replacer</span><span class='period'>.</span><span class='id identifier rubyid_process'>process</span><span class='lparen'>(</span><span class='id identifier rubyid_row'>row</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_field_group_cleaner'>field_group_cleaner</span><span class='period'>.</span><span class='id identifier rubyid_process'>process</span><span class='lparen'>(</span><span class='id identifier rubyid_row'>row</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_empty_groups'>empty_groups</span> <span class='op'>==</span> <span class='symbol'>:delete</span>
  <span class='id identifier rubyid_delim_only_cleaner'>delim_only_cleaner</span><span class='period'>.</span><span class='id identifier rubyid_process'>process</span><span class='lparen'>(</span><span class='id identifier rubyid_row'>row</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_row'>row</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Sep 11 18:40:25 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-2.7.8).
</div>

    </div>
  </body>
</html>