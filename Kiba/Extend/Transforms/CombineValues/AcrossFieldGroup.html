<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Kiba::Extend::Transforms::CombineValues::AcrossFieldGroup
  
    &mdash; Kiba-Extend Documentation
  
</title>

  <link rel="stylesheet" href="../../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Kiba::Extend::Transforms::CombineValues::AcrossFieldGroup";
  relpath = '../../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../Kiba.html" title="Kiba (module)">Kiba</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Extend.html" title="Kiba::Extend (module)">Extend</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Transforms.html" title="Kiba::Extend::Transforms (module)">Transforms</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../CombineValues.html" title="Kiba::Extend::Transforms::CombineValues (module)">CombineValues</a></span></span>
     &raquo; 
    <span class="title">AcrossFieldGroup</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Kiba::Extend::Transforms::CombineValues::AcrossFieldGroup
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Kiba::Extend::Transforms::CombineValues::AcrossFieldGroup</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/kiba/extend/transforms/combine_values.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
  <div class="note todo">
    <strong>TODO:</strong>
    <div class='inline'><p>Make transformer smarter about padding out blank values to the necessary number of blank values when combined.
This sort of assumes there will always be the same number of source fields mapped to each target field, but one
approach would be to find the max length (once split) of source fields in each row with index[i]:
person (0), statusc (2), date (1). Then pad accordingly. We&#39;d still have to make some assumption like
&quot;if there&#39;s 1 value in a column, but max ct of column values is 2, pad as &#39;2020;&#39; instead of &#39;;2020&#39;</p>
</div>
  </div>

<p>Combines values from multiple columns together as specified in fieldmap parameter.</p>

<p>Target field name can be the same as an existing field name.</p>

<h1 id="examples">Examples</h1>

<p>Input table:</p>

<pre class="code ruby"><code class="ruby">| person                  | statusa               | date             | personb | statusb   | date2 | personc | statusc    | date3 |
|---------------------------------------------------------------------------------------------------------------------------------|
| jim                     | approved              | 2020             | bill    | requested | 2019  | terri   | authorized |  2018 |
| jim;mavis               | approved;             | 2020;2021        | bill    | requested | 2019  | terri   | authorized |  2018 |
| nil                     | acknowledged          | 2020             | jill    | requested | nil   | bill    | followup   |  2021 |
| %NULLVALUE%;%NULLVALUE% | acknowledged;approved | 2020;%NULLVALUE% | jill    | requested | nil   | bill    | followup   |  2019 |
</code></pre>

<p>Used in pipeline as:</p>

<pre class="code ruby"><code class="ruby"> <span class='id identifier rubyid_transform'>transform</span> <span class='const'><span class='object_link'><a href="../CombineValues.html" title="Kiba::Extend::Transforms::CombineValues (module)">CombineValues</a></span></span><span class='op'>::</span><span class='const'>AcrossFieldGroup</span><span class='comma'>,</span>
   <span class='label'>fieldmap:</span> <span class='lbrace'>{</span>
               <span class='symbol'>:person</span> <span class='op'>=&gt;</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>person</span><span class='words_sep'> </span><span class='tstring_content'>personb</span><span class='words_sep'> </span><span class='tstring_content'>personc</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
               <span class='symbol'>:status</span> <span class='op'>=&gt;</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>statusc</span><span class='words_sep'> </span><span class='tstring_content'>statusa</span><span class='words_sep'> </span><span class='tstring_content'>statusb</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
               <span class='symbol'>:statusdate</span> <span class='op'>=&gt;</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>date</span><span class='words_sep'> </span><span class='tstring_content'>date2</span><span class='words_sep'> </span><span class='tstring_content'>date3</span><span class='tstring_end'>]</span></span>
             <span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>sep:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>;</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>Results in:</p>

<pre class="code ruby"><code class="ruby">| person                            | status                                   | statusdate             |
|-----------------------------------|------------------------------------------|------------------------|
| jim;bill;terri                    | authorized;approved;requested            | 2020;2019;2018         |
| jim;mavis;bill;terri              | authorized;approved;;requested           | 2020;2021;2019;2018    |
| ;jill;bill                        | followup;acknowledged;requested          | 2020;;2021             |
| %NULLVALUE%;%NULLVALUE%;jill;bill | followup;acknowledged;approved;requested | 2020;%NULLVALUE%;;2019 |
</code></pre>

<h2 id="note">NOTE</h2>

<p>If it is important that the number of values in each target column match in each row, depending on the situation, you may need to employ %NULLVALUE% or other placeholder value to ensure this. For example, contrast row 3 and 4 of the example. Row 3 works because an empty column value gets treated as a single value. Thus, it sees 3 person, status, and statusdate values, even though one person and one date value are nil.</p>

<p>If the person column of row 4 were like this:</p>

<pre class="code ruby"><code class="ruby">| person  | statusa               | date | personb | statusb   | date2 | personc | statusc    | date3 |
|---------|-----------------------|------|---------|-----------|-------|---------|------------|-------|
| nil     | acknowledged;approved | 2020 | jill    | requested | nil   | bill    | followup   |  2019 |
</code></pre>

<p>Then output would be:</p>

<pre class="code ruby"><code class="ruby">| person     | status                                   | statusdate |
|--------------------------------------------------------------------|
| ;jill;bill | followup;acknowledged;approved;requested | 2020;;2019 |
</code></pre>

<p>Depending on your requirements, this could be problematic because you now have 3 values in person and statusdate, but 4 values in status</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(fieldmap:, sep:, delete_sources: true)  &#x21d2; AcrossFieldGroup </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><h1 id="more-on-fieldmap-parameter">More on <code>fieldmap</code> parameter.</h1>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(fieldmap:, sep:, delete_sources: true)  &#x21d2; <tt><span class='object_link'><a href="" title="Kiba::Extend::Transforms::CombineValues::AcrossFieldGroup (class)">AcrossFieldGroup</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note todo">
    <strong>TODO:</strong>
    <div class='inline'><p>Raise error if unequal number of source fields given</p>
</div>
  </div>

<h1 id="more-on-fieldmap-parameter">More on <code>fieldmap</code> parameter</h1>

<ul>
<li><code>fieldmap</code> is a Hash</li>
<li>Each key is a target field, given as a Symbol, into which values from multiple other fields will be combined</li>
<li>Each value is an Array of Symbols. Each element of the array is a source field that will be mapped into the target field given as key. Order of source fields in this array controls the order in which the source fields are combined.</li>
<li>There must be an equal number of source fields given in each source field Array</li>
</ul>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>fieldmap</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Instructions on how to combine source fields into target fields. See above for fuller explanation of Hash format expectations</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>sep</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>String to use in splitting/joining the values</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>delete_sources</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Whether to delete source columns after values have been combined in target columns</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


87
88
89
90
91</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/kiba/extend/transforms/combine_values.rb', line 87</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='label'>fieldmap:</span><span class='comma'>,</span> <span class='label'>sep:</span><span class='comma'>,</span> <span class='label'>delete_sources:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='ivar'>@fieldmap</span> <span class='op'>=</span> <span class='id identifier rubyid_fieldmap'>fieldmap</span>
  <span class='ivar'>@sep</span> <span class='op'>=</span> <span class='id identifier rubyid_sep'>sep</span>
  <span class='ivar'>@del</span> <span class='op'>=</span> <span class='id identifier rubyid_delete_sources'>delete_sources</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


</div>

      <div id="footer">
  Generated on Wed May 18 21:05:51 2022 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.27 (ruby-2.7.6).
</div>

    </div>
  </body>
</html>